# 4. 统一开发流程 (Unified Development Process)

## 4.1 环境准备 (Setup)
接手本项目需要安装以下环境：
1.  **Rust**: 安装 `rustup`，确保 `cargo` 可用。
    - 运行 `rustup update` 确保是最新 stable 版本。
2.  **Node.js**: 推荐 v18 或 v20 (LTS)。
    - 包管理器：`npm` 或 `pnpm` (当前项目使用 npm)。
3.  **VS Code**: 推荐 IDE。
    - 插件：`Svelte for VS Code`, `rust-analyzer`, `Tauri`.

## 4.2 开发运行 (Running Dev)
1.  进入项目根目录。
2.  安装前端依赖：
    ```bash
    npm install
    ```
3.  启动混合开发模式 (Frontend HMR + Rust Watch)：
    ```bash
    npm run tauri dev
    ```
    - 这将同时启动 Vite 服务器 (:1420) 和 Tauri 窗口。
    - 修改 Rust 代码会自动重编译。
    - 修改 Svelte 代码会热更新。

## 4.3 调试流程 (Debugging)
- **前端调试**：
    - 在 Tauri 窗口中右键 -> `Inspect Element` 打开 DevTools。
    - 查看 Console 输出前端日志。
- **后端调试**：
    - 终端 (Terminal) 会输出 Rust 的 `println!` 或 `tracing` 日志。
    - 关键逻辑（如 OSC 接收）建议添加 `info!` 或 `debug!` 日志。

## 4.4 构建发布 (Build & Release)
1.  修改 `Source/Tauri/Cargo.toml` 和 `package.json` 中的版本号。
2.  运行构建命令：
    ```bash
    npm run tauri build
    ```
3.  构建产物位置：
    - Windows: `Source/Tauri/target/release/bundle/msi` 或 `nsis`。
    - 最终生成 `.exe` 安装包或独立可执行文件。

## 4.5 常见问题排查
- **EADDRINUSE 错误**：检查是否有其他软件占用了配置都在 9000/9001 端口。
- **WebView 白屏**：检查 Vite 是否启动成功，或 Rust 是否有 Panic 导致进程退出。
