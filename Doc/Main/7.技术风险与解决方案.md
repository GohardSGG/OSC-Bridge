# 7. 技术风险与解决方案 (Technical Risks and Solutions)

## 7.1 端口冲突 (Port Conflicts)
- **风险**: 用户配置的监听端口 (如 9000) 已被其他软件 (如 VRChat 自身) 占用，导致 Rust Panic 或无法接收数据。
- **解决方案**:
    - **当前**: Rust 层应捕获 `bind` 错误，并通过 Tauri Event 通知前端弹窗报错。
    - **建议**: 在“设置页”增加“端口检测”按钮，预先检测端口占用情况。

## 7.2 配置文件损坏 (Config Corruption)
- **风险**: 若在写入 `config.json` 时断电或程序崩溃，可能导致 JSON 格式错误，下次无法启动。
- **解决方案**:
    - 在写入前先写入 `config.json.tmp`，写入成功后再重命名覆盖 (`atomic write`)。
    - 启动时若解析失败，自动回滚到 `default` 配置并备份损坏文件。

## 7.3 高并发性能瓶颈 (Performance)
- **风险**: 当 OSC 数据包频率极高 (如 Mocap 动捕数据 > 1000Hz) 时，前端 WebSocket 可能处理不过来，导致 UI 卡顿。
- **解决方案**:
    - **后端降频**: 在 Rust 层做 Throttling (节流)，如限制发送给 UI 的 FPS 统计频率为 60Hz，而不是每包必发。
    - **数据采样**: 仅转发用于可视化的摘要数据，而非完整 Payload。

## 7.4 Windows 权限与防火墙
- **风险**: UDP 通信可能被 Windows Defender 防火墙拦截。
- **解决方案**:
    - 安装包 (MSI/NSIS) 制作时，脚本应自动添加防火墙入站规则。
    - 程序内部检测是否被拦截（较难实现），或在文档中显著提示用户“允许专用网络访问”。

## 7.5 DPI 缩放与绘制偏移
- **风险**: 也就是我们刚刚修复的 SetttingsModal 边缘模糊问题。Windows 的 DPI 缩放可能导致 webview 渲染坐标与系统物理像素不对齐。
- **解决方案**:
    - 必须在 CSS 中预留安全边距 (如 `right-[4px]`)。
    - 避免使用 `fixed inset-0` 这种全覆盖布局，始终考虑窗口边框的存在。
